<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Admin - Painel de Controle do Torneio</title>
    <link href="https://fonts.googleapis.com/css2?family=Creepster&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
    font-family: 'Roboto', sans-serif;
    color: #f0f0f0;
    padding: 20px;
    
    /* INÍCIO DA ALTERAÇÃO */
    background-image: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('https://i.postimg.cc/CMCsSNkS/5ZuHria.gif');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    /* FIM DA ALTERAÇÃO */
}
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { font-family: 'Creepster', cursive; color: #ff4d4d; text-align: center; font-size: 3rem; }
        .admin-panel { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; }
        .panel-section { background-color: #2c2c2c; padding: 20px; border-radius: 10px; }
        h2 { font-family: 'Creepster', cursive; color: #ff4d4d; border-bottom: 1px solid #4a0e0e; padding-bottom: 10px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; }
        input { width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #555; background-color: #1a1a1a; color: #f0f0f0; font-size: 1rem; box-sizing: border-box; }
        button { padding: 10px 15px; border-radius: 5px; border: none; background-color: #8B0000; color: white; cursor: pointer; transition: background-color 0.3s; }
        button:hover:not(:disabled) { background-color: #ff4d4d; }
        button:disabled { background-color: #555; cursor: not-allowed; }
        .btn-delete { background-color: #444; }
        #status { text-align: center; margin-top: 20px; font-weight: bold; min-height: 20px; }
        .entry-list { list-style: none; padding: 0; }
        .entry-list li { background-color: #3a3a3a; padding: 10px; border-radius: 5px; margin-bottom: 10px; display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 10px; }
        .entry-list .info { flex-grow: 1; }
        .entry-list input { width: 80px; margin: 0 10px; }
        .entry-list .actions { display: flex; gap: 10px; }
        @media (max-width: 900px) { .admin-panel { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div class="container">
        <h1>Painel de Controle</h1>
        <div class="form-group">
            <label for="password">Senha de Administrador</label>
            <input type="password" id="password" placeholder="Digite a senha para habilitar os botões">
        </div>
        <p id="status"></p>

        <div class="admin-panel">
            <div class="panel-section">
                <h2>Gerenciar Times de Sobreviventes</h2>
                <div class="form-group">
                    <label for="team-name">Nome do Novo Time</label>
                    <input type="text" id="team-name">
                </div>
                <div class="form-group">
                    <label for="team-score">Pontuação Inicial</label>
                    <input type="number" id="team-score" value="0">
                </div>
                <button id="add-team-btn" disabled>Adicionar Time</button>
                <hr style="border-color: #4a0e0e; margin: 20px 0;">
                <h3>Times Atuais</h3>
                <ul id="teams-list" class="entry-list"></ul>
            </div>

            <div class="panel-section">
                <h2>Gerenciar Assassinos</h2>
                <div class="form-group">
                    <label for="killer-name">Nome do Novo Assassino</label>
                    <input type="text" id="killer-name">
                </div>
                <div class="form-group">
                    <label for="killer-score">Pontuação Inicial</label>
                    <input type="number" id="killer-score" value="0">
                </div>
                <button id="add-killer-btn" disabled>Adicionar Assassino</button>
                <hr style="border-color: #4a0e0e; margin: 20px 0;">
                <h3>Assassinos Atuais</h3>
                <ul id="killers-list" class="entry-list"></ul>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script>
    // --- COLE AQUI A MESMA CONFIGURAÇÃO DO FIREBASE ---
    const firebaseConfig = {
        apiKey: "AIzaSyA_eqbuIT9Pe3z1NlTG6EQIForIM3uNv_c",
        authDomain: "placar-dbd-torneio.firebaseapp.com",
        databaseURL: "https://placar-dbd-torneio-default-rtdb.firebaseio.com",
        projectId: "placar-dbd-torneio",
        storageBucket: "placar-dbd-torneio.appspot.com",
        messagingSenderId: "704704412861",
        appId: "1:704704412861:web:0a9214ac40b9518fa64bd4",
        measurementId: "G-SJL640013X"
    };
    // --- FIM DA CONFIGURAÇÃO ---

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    document.addEventListener('DOMContentLoaded', function() {
        const ADMIN_PASSWORD = "@Mateus2024";
        
        const passwordInput = document.getElementById('password');
        const statusElement = document.getElementById('status');
        const allButtons = document.querySelectorAll('button');

        const teamsRef = database.ref('teams');
        const killersRef = database.ref('killers');

        const addTeamBtn = document.getElementById('add-team-btn');
        const teamNameInput = document.getElementById('team-name');
        const teamScoreInput = document.getElementById('team-score');
        const teamsList = document.getElementById('teams-list');

        const addKillerBtn = document.getElementById('add-killer-btn');
        const killerNameInput = document.getElementById('killer-name');
        const killerScoreInput = document.getElementById('killer-score');
        const killersList = document.getElementById('killers-list');

        passwordInput.addEventListener('input', () => {
            const isPasswordCorrect = passwordInput.value === ADMIN_PASSWORD;
            // Habilita ou desabilita TODOS os botões da página
            document.querySelectorAll('button').forEach(btn => {
                btn.disabled = !isPasswordCorrect;
            });
            
            if (isPasswordCorrect) {
                statusElement.textContent = "Acesso liberado.";
                statusElement.style.color = "#4CAF50";
            } else {
                statusElement.textContent = "";
            }
        });

        function createListUpdater(ref, listElement) {
            ref.on('value', (snapshot) => {
                const isPasswordCorrect = passwordInput.value === ADMIN_PASSWORD;
                listElement.innerHTML = '';
                const data = snapshot.val();
                if (data) {
                    Object.keys(data).forEach((key) => {
                        const entry = data[key];
                        const li = document.createElement('li');
                        li.innerHTML = `
                            <span class="info">${entry.name}</span>
                            <div class="actions">
                                <input type="number" value="${entry.score}" id="score-${key}">
                                <button id="update-${key}">Atualizar</button>
                                <button id="delete-${key}" class="btn-delete">Remover</button>
                            </div>
                        `;
                        listElement.appendChild(li);
                        
                        const updateBtn = document.getElementById(`update-${key}`);
                        const deleteBtn = document.getElementById(`delete-${key}`);

                        // ## INÍCIO DA CORREÇÃO ##
                        // Garante que os novos botões também fiquem desabilitados se a senha não estiver correta
                        updateBtn.disabled = !isPasswordCorrect;
                        deleteBtn.disabled = !isPasswordCorrect;
                        // ## FIM DA CORREÇÃO ##

                        updateBtn.addEventListener('click', () => {
                            const newScore = document.getElementById(`score-${key}`).value;
                            ref.child(key).update({ score: parseInt(newScore, 10) });
                        });

                        deleteBtn.addEventListener('click', () => {
                            if (confirm(`Tem certeza que deseja remover "${entry.name}"?`)) {
                                ref.child(key).remove();
                            }
                        });
                    });
                }
            });
        }
        
        createListUpdater(teamsRef, teamsList);
        createListUpdater(killersRef, killersList);
        
        addTeamBtn.addEventListener('click', () => {
            const name = teamNameInput.value;
            const score = parseInt(teamScoreInput.value, 10);
            if (name) {
                teamsRef.push({ name, score });
                teamNameInput.value = '';
                teamScoreInput.value = '0';
            }
        });

        addKillerBtn.addEventListener('click', () => {
            const name = killerNameInput.value;
            const score = parseInt(killerScoreInput.value, 10);
            if (name) {
                killersRef.push({ name, score });
                killerNameInput.value = '';
                killerScoreInput.value = '0';
            }
        });
    });
    </script>
</body>
</html>
